<div class="go-playground" id="playground-{{ .Get "id" | default "default" }}">
<div class="playground-header">
    <h4>Go Playground</h4>
    <div class="playground-actions">
        <button class="playground-btn" onclick="runGoCode('{{ .Get "id" | default "default" }}')">
        ‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å
        </button>
        <button class="playground-btn" onclick="formatGoCode('{{ .Get "id" | default "default" }}')">
        üõ† –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å
        </button>
        <button class="playground-btn" onclick="resetGoCode('{{ .Get "id" | default "default" }}')">
        ‚ü≥ –°–±—Ä–æ—Å–∏—Ç—å
        </button>
    </div>
</div>

<!-- –î–≤–æ–π–Ω–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä: textarea –¥–ª—è –≤–≤–æ–¥–∞ + pre –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ -->
<div class="editor-container">
    <textarea
            id="go-code-{{ .Get "id" | default "default" }}"
    class="go-code-textarea"
    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à Go –∫–æ–¥ –∑–¥–µ—Å—å..."
    spellcheck="false"
    oninput="updateHighlight('{{ .Get "id" | default "default" }}')"
    onscroll="syncScroll('{{ .Get "id" | default "default" }}')"
    >{{ .Inner | htmlUnescape }}</textarea>
    <pre class="go-code-highlight" id="highlight-{{ .Get "id" | default "default" }}"><code class="language-go">{{ .Inner | htmlUnescape }}</code></pre>
</div>

<div class="playground-output">
    <div class="output-header">
        <span>–í—ã–≤–æ–¥:</span>
        <button class="clear-btn" onclick="clearOutput('{{ .Get "id" | default "default" }}')">
        –û—á–∏—Å—Ç–∏—Ç—å
        </button>
    </div>
    <pre id="output-{{ .Get "id" | default "default" }}" class="output-content"></pre>
</div>
</div>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/components/prism-go.min.js"></script>

<script>
    function runGoCode(id) {
        const textarea = document.getElementById(`go-code-${id}`);
        const outputElement = document.getElementById(`output-${id}`);
        const code = textarea.value;

        outputElement.textContent = '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ...';

        // –ò—Å–ø–æ–ª—å–∑—É–µ–º Go Playground API
        fetch('https://play.golang.org/compile', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `body=${encodeURIComponent(code)}`
        })
            .then(response => response.json())
            .then(data => {
                if (data.Errors) {
                    outputElement.textContent = '–û—à–∏–±–∫–∞: ' + data.Errors;
                } else {
                    let output = '';
                    if (data.Events) {
                        data.Events.forEach(event => {
                            if (event.Message) {
                                output += event.Message;
                            }
                        });
                    }
                    outputElement.textContent = output || '–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ (–Ω–µ—Ç –≤—ã–≤–æ–¥–∞)';
                }
            })
            .catch(error => {
                outputElement.textContent = '–û—à–∏–±–∫–∞: ' + error.message;
            });
    }

    function updateHighlight(id) {
        const textarea = document.getElementById(`go-code-${id}`);
        const highlight = document.getElementById(`highlight-${id}`);
        const code = textarea.value;

        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–≤–µ—á–µ–Ω–Ω—ã–π –∫–æ–¥
        highlight.innerHTML = code ? Prism.highlight(code, Prism.languages.go, 'go') : '';

        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –≤—ã—Å–æ—Ç—É
        highlight.style.height = textarea.scrollHeight + 'px';
    }

    function syncScroll(id) {
        const textarea = document.getElementById(`go-code-${id}`);
        const highlight = document.getElementById(`highlight-${id}`);
        highlight.scrollTop = textarea.scrollTop;
        highlight.scrollLeft = textarea.scrollLeft;
    }

    function formatGoCode(id) {
        const textarea = document.getElementById(`go-code-${id}`);
        const code = textarea.value;

        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ gofmt —á–µ—Ä–µ–∑ API
        // –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–æ–¥
        updateHighlight(id);
    }

    function resetGoCode(id) {
        const textarea = document.getElementById(`go-code-${id}`);
        textarea.value = 'package main\n\nimport "fmt"\n\nfunc main() {\n    fmt.Println("Hello, World!")\n}';
        updateHighlight(id);
    }

    function clearOutput(id) {
        const outputElement = document.getElementById(`output-${id}`);
        outputElement.textContent = '';
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', function() {
        // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ playground-—ã –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É
        const playgrounds = document.querySelectorAll('.go-playground');
        playgrounds.forEach(playground => {
            const id = playground.id.replace('playground-', '');
            updateHighlight(id);
        });
    });
</script>

<style>
    .editor-container {
        position: relative;
        background: #f5f5f5;
        border: 1px solid #ccc;
        border-radius: 4px;
        overflow: hidden;
    }

    .go-code-textarea {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        padding: 1rem;
        border: none;
        background: transparent;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 14px;
        line-height: 1.5;
        color: transparent;
        caret-color: black; /* –¶–≤–µ—Ç –∫—É—Ä—Å–æ—Ä–∞ */
        resize: none;
        z-index: 2;
        overflow: auto;
        white-space: pre;
    }

    .go-code-highlight {
        margin: 0;
        padding: 1rem;
        background: transparent;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 14px;
        line-height: 1.5;
        overflow: auto;
        min-height: 200px;
    }

    .go-code-highlight code {
        background: transparent !important;
    }

    /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ Prism –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –ª–∏—à–Ω–∏–µ —Å—Ç–∏–ª–∏ */
    .token.keyword { color: #07a; }
    .token.string { color: #690; }
    .token.comment { color: #999; }
    .token.function { color: #DD4A68; }
    .token.number { color: #905; }
</style>