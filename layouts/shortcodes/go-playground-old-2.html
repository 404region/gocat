<div class="custom-go-playground">
    <div class="toolbar">
        <button onclick="runCode(this)">Run</button>
        <button onclick="shareCode(this)">Share</button>
        <select onchange="changeTheme(this)">
            <option value="monokai">Monokai</option>
            <option value="github">GitHub</option>
            <option value="dracula">Dracula</option>
        </select>
    </div>

    <!-- Редактор с подсветкой -->
    <div class="editor-container">
        <pre><code class="language-go" contenteditable="true">{{ .Inner }}</code></pre>
    </div>

    <!-- Результат выполнения -->
    <div class="output-container">
        <div class="output-header">Output</div>
        <pre class="output-content"></pre>
    </div>
</div>

<!-- Подключаем библиотеку для подсветки -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/components/prism-go.min.js"></script>

<script>
    function runCode(button) {
        const wrapper = button.closest('.custom-go-playground');
        const code = wrapper.querySelector('code').textContent;
        const output = wrapper.querySelector('.output-content');

        output.textContent = 'Running...';

        // Используем Go Playground API
        fetch('https://play.golang.org/compile', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `body=${encodeURIComponent(code)}`
        })
            .then(response => response.json())
            .then(data => {
                if (data.Errors) {
                    output.textContent = 'Error: ' + data.Errors;
                } else {
                    output.textContent = data.Events?.[0]?.Message || 'No output';
                }
            });
    }

    function changeTheme(select) {
        // Меняем тему Prism
        const link = document.querySelector('link[href*="prism"]');
        link.href = `https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-${select.value}.min.css`;
    }
</script>

<style>
    .custom-go-playground {
        border: 1px solid #ccc;
        border-radius: 8px;
        margin: 1rem 0;
    }

    .editor-container {
        background: #f6f8fa;
        padding: 1rem;
    }

    .editor-container code {
        background: none !important;
    }

    .output-container {
        border-top: 1px solid #ccc;
        background: white;
    }

    .output-header {
        background: #f0f0f0;
        padding: 0.5rem 1rem;
        font-weight: bold;
    }

    .output-content {
        padding: 1rem;
        margin: 0;
        min-height: 100px;
    }
</style>